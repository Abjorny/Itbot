<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script
    src="https://code.jquery.com/jquery-3.6.3.js"
    integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
    crossorigin="anonymous"></script>
</head>
<body>
    
    <div class="calcu_bank">
        <div class="calcu_bank_Selected_Pravo">
            <span>Закон</span>
            <select id ="bank_zakon_id">
                <option value="0">44-Ф3</option>
                <option value="1">223-Ф3</option>
                <option value="2">615 ПП</option>
                <option value="3">Комерция</option>
            </select>
        </div>
        <div class="calcu_bank_Selected_garant">
            <span>Вид гарантии</span>
            <select>
                <option value="0">Обеспечение участия</option>
                <option value="1">Обеспечение исполнения контракта</option>
                <option value="2">Гарантийные обязательства</option>
                <option value="3">Возврат аванса</option>
                <option value="4">Гарантия платежа</option>
                <option value="5">Налоговая гарантия (НДС, акцизы)</option>
            </select>
        </div>
        <div class="calcu_bank_Selected_price">
            <input id ="calcu_bank_Selected_price_input" type="number" class="calcu_bank_Selected_price_input" id="quantity" name="quantity" placeholder="Укажите сумму" >
        </div>

        <div class="calcu_bank_Selected_data"  id="dateRange">
            <img src="clarity_date-line.svg">
            <input type="number" class="calcu_bank_Selected_price_input" id="datevalue" name="quantity" placeholder="Укажите срок" >
        </div>
        <button id = "calcu_bank_button" class="calcu_bank_button" style="font-weight: 600;">РАССЧИТАТЬ</button>


        <div class="calcu_bank_Selected_contaier">
            <span class ="bank_zagolovok_bank" >Банк</span>
            <span class ="bank_zagolovok_stavka" >Ставка, % годовых</span>
            <span class ="bank_zagolovok_price" >Стоимость, руб.</span>
        </div>
    </div>
    <div class ="calcu_bank_content_table">

    </div>
    
</body>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
    flatpickr("#dateRange", {
        mode: "range",
        dateFormat: "Y-m-d",
        onClose: function(selectedDates, dateStr, instance) {
            if (selectedDates.length === 2) {
                const diffTime = Math.abs(selectedDates[1] - selectedDates[0]);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                document.getElementById('datevalue').value = diffDays;
            }
        },
        onReady: function(selectedDates, dateStr, instance) {
            const calendarIcon = document.getElementById('calendarIcon');
            calendarIcon.addEventListener('click', function() {
                instance.open();
            });
        }
    });
    
    let arrayOfObjects = [
    {
        name: "Промсвязьбанк",
        0: 3,
        1: 3,
        2: 3,
        3: 4.5
    },
    {
        name: "АК БАРС",
        0: 3.5,
        1: 3.5,
        2: 0,
        3: 5
    },
    {
        name: "МТС БАНК",
        0: 2.95,
        1: 2.95,
        2: 3.1,
        3: 0
    },
    {
        name: "МКБ",
        0: 2.5,
        1: 2.5,
        2: 0,
        3: 4.5
    },
    {
        name: "Банк ВТБ",
        0: 2.2,
        1: 2.2,
        2: 3,
        3: 4
    },
    {
        name: "Банк \"Санкт-Петербург\"",
        0: 3.2,
        1: 3.2,
        2: 0,
        3: 4.5
    },
    {
        name: "ИНГОССТРАХ БАНК",
        0: 3.1,
        1: 3.1,
        2: 0,
        3: 4.6
    },
    {
        name: "Газпромбанк",
        0: 2.8,
        1: 2.8,
        2: 3.2,
        3: 4
    },
    {
        name: "Уралсиб",
        0: 2.85,
        1: 2.85,
        2: 0,
        3: 0
    },
    {
        name: "Абсолют",
        0: 2.8,
        1: 2.8,
        2: 2.8,
        3: 4.2
    },
    {
        name: "Сбербанк",
        0: 2,
        1: 2,
        2: 0,
        3: 3.5
    },
    {
        name: "Совкомбанк",
        0: 3.49,
        1: 3.49,
        2: 0,
        3: 5.5
    },
    {
        name: "Солид Банк",
        0: 2.9,
        1: 2.9,
        2: 2.92,
        3: 0
    },
    {
        name: "Реалист Банк",
        0: 3.16,
        1: 3.16,
        2: 1.72,
        3: 4.1
    },
    {
        name: "Альфа-Банк",
        0: 3,
        1: 3,
        2: 2.85,
        3: 4
    },
    {
        name: "Зенит",
        0: 3,
        1: 3,
        2: 3.1,
        3: 4.6
    },
    {
        name: "СГБ",
        0: 2.8,
        1: 2.8,
        2: 2.64,
        3: 4.2
    },
    {
        name: "МСП",
        0: 2.7,
        1: 2.7,
        2: 3,
        3: 4
    },
    {
        name: "Металлинвест",
        0: 2.5,
        1: 2.5,
        2: 0,
        3: 3.7
    },
    {
        name: "ЛОКО-Банк",
        0: 1.9,
        1: 1.9,
        2: 3.1,
        3: 0
    },
    {
        name: "Примсоцбанк",
        0: 2,
        1: 2,
        2: 0,
        3: 0
    },
    {
        name: "РУСНАРБАНК",
        0: 2.7,
        1: 2.7,
        2: 0,
        3: 4
    },
    {
        name: "Банк Держава",
        0: 3.1,
        1: 3.1,
        2: 2.91,
        3: 3.8
    },
    {
        name: "Райффайзен Банк",
        0: 1.9,
        1: 1.9,
        2: 3.1,
        3: 3.1
    },
    {
        name: "SBI Банк",
        0: 2.6,
        1: 2.6,
        2: 0,
        3: 4.3
    },
    {
        name: "Левобережный",
        0: 2.1,
        1: 2.1,
        2: 3,
        3: 4.25
    },
    {
        name: "Алеф Банк",
        0: 3.2,
        1: 3.2,
        2: 0,
        3: 0
    },
    {
        name: "Банк Солидарность",
        0: 2.5,
        1: 2.5,
        2: 3.15,
        3: 4.5
    },
    {
        name: "Банк Россия",
        0: 2,
        1: 2,
        2: 0,
        3: 4.1
    },
    {
        name: "Кредит Урал Банк",
        0: 2.7,
        1: 2.7,
        2: 0,
        3: 0
    }
];
jQuery('#datevalue').change(function() {
    jQuery('#datevalue').css('border', '1px solid #B1B1B1');
});
jQuery('#calcu_bank_Selected_price_input').change(function() {
    jQuery('#calcu_bank_Selected_price_input').css('border', '1px solid #B1B1B1');
});
$(document).ready(function() {
            
            $('#calcu_bank_button').click(function() {
                let container = document.querySelector('.calcu_bank_content_table');
                let selectedValue =  Number(jQuery('#bank_zakon_id').val());
                let price = Number ( jQuery('#calcu_bank_Selected_price_input').val());
                let days = Number ( jQuery('#datevalue').val());
                if (price == 0){
                    jQuery('#calcu_bank_Selected_price_input').css('border', '2px solid red');
                    return
                }
                if (days == 0){
                    jQuery('#datevalue').css('border', '2px solid red');
                    return
                }

                while (container.firstChild) {
                container.removeChild(container.firstChild);
                }
                for (let i = 0; i < arrayOfObjects.length; i++) {
 
                let percentToAdd = price * (arrayOfObjects[i][selectedValue] / 100);
                let result = ( percentToAdd/365*days)

                let tableDiv = document.createElement('div');
                tableDiv.className = 'calcu_bank_table';
                let span1 = document.createElement('span');
                span1.textContent = String(arrayOfObjects[i]["name"]);
                span1.classList.add('name_bank_table');
                let span3 = document.createElement('span');
                let span2 = document.createElement('span');
                if (arrayOfObjects[i][selectedValue]==0){
                    span2.textContent = '---';
                    span3.textContent = "---";
                }
                else{
                    span2.textContent = String(arrayOfObjects[i][selectedValue]) + '% годовых';
                    span3.textContent = String(Math.round(result))+ " руб";
                }

                span2.classList.add('procent_bank_table');
        
     
                span3.classList.add('price_bank_table');
                tableDiv.appendChild(span1);
                tableDiv.appendChild(span2);
                tableDiv.appendChild(span3);
                container.appendChild(tableDiv);
                }
            });
        });
</script>
</html>